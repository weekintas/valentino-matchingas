{% from '_single_match_row.html' import single_match_row %}


<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <!-- Poppins google font -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:ital,wght@0,400;0,700;1,400;1,700&display=swap" rel="stylesheet">

    <style>
      @page {
        size: A4;
        margin: 20mm;
      }
      body {
        margin: 0;
        padding: 0;
        font-family: "Poppins", serif;
        color: #333;
        line-height: 1.6;
        font-size: 18px;
      }
      .header {
        background-color: #d6336c;
        color: #fff;
        padding: 20px;
        text-align: center;
        font-size: 30px;
        font-weight: bold;
      }
      .header span {
        display: block;
        font-size: 20px;
        margin-top: 5px;
      }
      .greeting {
        margin-top: 20px;
        text-align: center;
        padding: 15px;
        font-size: 24px;
        color: #444;
      }
      .description {
        text-align: center;
        font-size: 20px;
        color: #444;
        margin: -10px 20px 30px;
      }
      .highlight {
        background-color: #ffe6eb;
        padding: 15px;
        border-radius: 6px;
        margin: 20px 20px 0 20px;
        text-align: center;
        border: 2px solid #d6336c;
      }
      .highlight .name {
        font-size: 22px;
        font-weight: bold;
        color: #c90e50;
      }
      .highlight .score {
        font-size: 20px;
        color: #444;
      }
      .matches {
        padding: 20px;
      }
      .match-group {
        margin-bottom: 20px;
      }
      .match-group h2 {
        font-size: 22px;
        margin-top: 30px;
        margin-bottom: 10px;
        color: #d6336c;
        border-bottom: 2px solid #ffe6eb;
        padding-bottom: 5px;
      }
      .match-group ul {
        list-style: none;
        padding: 0;
      }

      .two-match-row {
        display: -webkit-box;
        display: -webkit-flex;
        display: flex;
        -webkit-box-pack: center;
        -webkit-justify-content: center;
        justify-content: center;
        -webkit-box-align: center;
        -webkit-align-items: center;
        align-items: center;
        column-gap: 10px;
      }

      .single-match-row {
        text-align: left;
        background: #ffedee;
        margin: 5px;
        padding: 10px;
        border-radius: 5px;
        box-sizing: border-box; /* Ensure padding doesnâ€™t affect size */
        color: #333;

        display: -webkit-box;
        display: flex;
        -webkit-box-pack: center;
        justify-content: space-between;
        box-sizing: border-box;

        width: 49%;
        flex-shrink: 0;
        flex-grow: 0;
      }
      .match-group li.top-match {
        background-color: #ffd1dc;
        font-weight: bold;
        width: 99%;
      }
      
      .single-match-row > .name {
        -webkit-box-flex: 1;
        -webkit-flex: 1;
        flex: 1;
        text-align: left;
        justify-content: left;
        align-content: start;
      }
      .single-match-row > .percentage {
        -webkit-box-flex: 0;
        -webkit-flex: 0;
        flex: 0;
        text-align: center;
        justify-content: center;
        align-content: center;
        margin-left: 10px;
      }
    </style>
  </head>
  <body>
    <div class="header">
      Your Valentine results are here!
      <span>Take a look at your best Valentine's matches!</span>
    </div>
    <!-- Greeting Section -->
    <div class="greeting">
      Hey, <strong>{{ full_name }}</strong>!
    </div>
    <div class="description">
      We've crunched the numbers and present you your top Valentine's matches:
    </div>
    <!-- Top Match Highlight -->
    <div class="highlight">
      <div class="name">Your top match: {{ top_match_name }}</div>
      <div class="score">Compatibility: <strong>{{ top_match_compatibility }}%</strong></div>
    </div>
    <div class="matches">
      {% for match_group in match_groups %}
        <div class="match-group">
          <h2>{{ match_group }}:</h2>
          <ul>
            {% for match in match_groups[match_group] %}
              <!-- If this is the first match in the match_group, display them full-width (since it is the top match in that group) -->
              {% if loop.first %}
                {{ single_match_row(match.name, match.compatibility, is_top_match=true) }}
                {% continue %}
              {% endif %}
              
              <!-- Only do every other loop, since in each loop we take two values from the loop -->
              {% if loop.index0 is divisibleby 2 %}
                {% continue %}
              {% endif %}

              <ul class="two-match-row">
                {{ single_match_row(match.name, match.compatibility) }}
                
                <!-- if this is the last match in the group, there is no second match to display, so we break -->
                {% if loop.last %}
                  {% break %}
                {% endif %}

                {{ single_match_row(loop.nextitem.name, loop.nextitem.compatibility) }}
              </ul>
            {% endfor %}
          </ul>
        </div>
      {% endfor %}
    </div>
  </body>
</html>